{
  "comments": [
    {
      "key": {
        "uuid": "19bce1a2_d3d0201b",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-14T18:31:55Z",
      "side": 1,
      "message": "I prefer the explicit usage of if statement to the variable expansion with error message.  Please keep the old one.",
      "range": {
        "startLine": 18,
        "startChar": 0,
        "endLine": 18,
        "endChar": 2
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "143e4f10_a0c80738",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1344584
      },
      "writtenOn": "2019-11-15T03:35:05Z",
      "side": 1,
      "message": "This reduces 25 lines of boilerplate code to 10, and it is not really kludgy.",
      "parentUuid": "19bce1a2_d3d0201b",
      "range": {
        "startLine": 18,
        "startChar": 0,
        "endLine": 18,
        "endChar": 2
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "62faf46f_fc8f82d0",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-15T05:00:18Z",
      "side": 1,
      "message": "8-line reduction (L27-L34) is contributed by folding the case statement into an array lookup.  I agree that part is better.\n\nHowever, different people have different preferences in coding style.  I personally don\u0027t like the idea of doing multiple things in one line and would like to avoid those advanced shell script techniques in this script (whenever possible).",
      "parentUuid": "143e4f10_a0c80738",
      "range": {
        "startLine": 18,
        "startChar": 0,
        "endLine": 18,
        "endChar": 2
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "abaf1049_715f1330",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1344584
      },
      "writtenOn": "2019-11-16T01:32:03Z",
      "side": 1,
      "message": "I hear that the popular notion is \"write idiomatic code\" :-)\nTo me these two things: :? expansion to check that the variable is set and using \u0027(test) \u0026\u0026  var\u003dxxx\u0027 to assign the value conditionally are bash idioms, and used judiciously they reduce bolerplate code.\nPlease consider.",
      "parentUuid": "62faf46f_fc8f82d0",
      "range": {
        "startLine": 18,
        "startChar": 0,
        "endLine": 18,
        "endChar": 2
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de659d97_73c39f19",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 18,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-19T18:56:07Z",
      "side": 1,
      "message": "After long consideration, I still can\u0027t sincerely love this syntax.  As I expect that I will read and maintain this script in the future, I really hope this script does not evolve to that style, regardless that style is idiomatic or not.  Thank you for your suggestion but may you split this out of this CL?\n\nAlternatively, since hsinyichen@ may maintain this script in the future as well.  If he prefers that style and willing to give CR+2 proactively, I am fine with it.\n\nBut in either cases, code refactoring and adding the --resume option should be done in separate CLs.  Please only do one thing in this CL: add \"proto_metadata_plugin\".",
      "parentUuid": "abaf1049_715f1330",
      "range": {
        "startLine": 18,
        "startChar": 0,
        "endLine": 18,
        "endChar": 2
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f61d6a47_600e6a0b",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-14T18:31:55Z",
      "side": 1,
      "message": "Same here.\n\nI prefer:\n\n    OS\u003d\"${oses[$(uname)]}\"\n    if [ -z \"${OS}\" ]; then\n        echo \"error: Unknown uname: ${UNAME}\"\n    fi\n\nAlso, please keep \"uname\" in the error message.  Users won\u0027t be able to understand what\u0027s wrong with \"Unknown blabla\".",
      "range": {
        "startLine": 21,
        "startChar": 20,
        "endLine": 21,
        "endChar": 40
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3712def6_a26e1855",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1344584
      },
      "writtenOn": "2019-11-15T03:35:05Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f61d6a47_600e6a0b",
      "range": {
        "startLine": 21,
        "startChar": 20,
        "endLine": 21,
        "endChar": 40
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ef009dd9_26900aff",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-15T05:00:18Z",
      "side": 1,
      "message": "I just noticed that to avoid \"bad array subscript\" error message, we should check the membership first:\n\n    UNAME\u003d\"$(uname)\"\n    if [ ! -v oses[\"${UNAME}\"] ]; then\n        echo \"error: Unknown uname: ${UNAME}\"\n        exit 1\n    fi\n    OS\u003d\"${oses[\"${UNAME}\"]}\"",
      "parentUuid": "3712def6_a26e1855",
      "range": {
        "startLine": 21,
        "startChar": 20,
        "endLine": 21,
        "endChar": 40
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6e964ae_e26e88ed",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1344584
      },
      "writtenOn": "2019-11-16T01:32:03Z",
      "side": 1,
      "message": "There is no need, :? takes care of that here, too:\n$ declare -Ar oses\u003d([xxLinux]\u003dlinux [Darwin]\u003ddarwin) ; OS\u003d\"${oses[$(uname)]:?Unknown uname: $(uname)}\" )\nbash: oses[$(uname)]: Unknown uname: Linux",
      "parentUuid": "ef009dd9_26900aff",
      "range": {
        "startLine": 21,
        "startChar": 20,
        "endLine": 21,
        "endChar": 40
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f358e9b7_347edcee",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-19T18:56:07Z",
      "side": 1,
      "message": "Never mind on the \"bad array subscript\" part.  I was testing the array subscription with empty strings:\n\n    declare -Ar A\u003d([ABC]\u003d123 [DEF]\u003d456)\n    echo \"${A[\"${opt}\"]}\"\n\nSince $(uname) is unlikely to be expanded into empty strings, it might be fine.",
      "parentUuid": "d6e964ae_e26e88ed",
      "range": {
        "startLine": 21,
        "startChar": 20,
        "endLine": 21,
        "endChar": 40
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a3fdc84_9fd8237c",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 23,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-14T18:31:55Z",
      "side": 1,
      "message": "if [ \"${1}\" \u003d \"--resume\" ]; then\n    resume\u003d\"true\"\nfi",
      "range": {
        "startLine": 22,
        "startChar": 0,
        "endLine": 23,
        "endChar": 40
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "32c15a56_088287ac",
        "filename": "vndk/tools/header-checker/android/build-prebuilts.sh",
        "patchSetId": 1
      },
      "lineNbr": 28,
      "author": {
        "id": 1014807
      },
      "writtenOn": "2019-11-14T18:31:55Z",
      "side": 1,
      "message": "if [ -z \"${resume}\" ]; then\n    rm -rf \"${SOONG_OUT}\"\nfi",
      "range": {
        "startLine": 28,
        "startChar": 0,
        "endLine": 28,
        "endChar": 44
      },
      "revId": "269aa247edac11378ca164c50553e0276c7cae39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}